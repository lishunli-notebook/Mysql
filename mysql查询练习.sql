--


--numeric(a,b)表示最大可以放a位数，但这a位数里有b位是小数
--decimal 
--money

学生表
Student
	学号
	姓名
	性别
	出生年月日
	所在班级

create table student(
	sno varchar(20) primary key,
	sname varchar(20) not null,
	ssex varchar(20),
	sbirthday datetime,
	class varchar(20)
);



教师表
Teacher
	教师编号
	教师名字
	教师性别
	出生年月日
	职称
	所在部门
create table teacher(
	tno varchar(20) primary key,
	tname varchar(20) not null,
	tsex varchar(20) not null,
	tbirthday datetime,
	prof varchar(20) not null,
	depart varchar(20) not null
); 



课程表
Course
	课程号
	课程名称
	教师编号

create table course(
	cno varchar(20) primary key,
	cname varchar(20) not null,
	tno varchar(20) not null,
	foreign key(tno) references teacher(tno)
);


成绩表
Score
	学号
	课程号
	成绩
create table score(
	sno varchar(20),
	cno varchar(20) not null,
	degree decimal,
	foreign key(sno) references student(sno),
	foreign key(cno) references course(cno),
	primary key(sno, cno)
);

--添加数据
##学生信息
insert into student values('101', '曾华', '男', '1977-09-01', '95033');
insert into student values('102', '匡明', '男', '1975-10-02', '95031');
insert into student values('103', '王丽', '女', '1976-01-23', '95033');
insert into student values('104', '李军', '男', '1976-02-20', '95033');
insert into student values('105', '王芳', '女', '1975-02-10', '95031');
insert into student values('106', '陆君', '男', '1974-06-03', '95031');
insert into student values('107', '王尼玛', '男', '1977-06-07', '95031');
insert into student values('108', '张全蛋', '男', '1973-08-12', '95033');
insert into student values('109', '赵铁柱', '男', '1975-06-30', '95031');

#教师数据
insert into teacher values('804', '李成', '男', '1958-12-02', '副教授', '计算机系');
insert into teacher values('856', '张旭', '男', '1966-03-12', '讲师', '电子工程系');
insert into teacher values('825', '王萍', '女', '1974-05-05', '助教', '计算机系');
insert into teacher values('831', '刘冰', '女', '1975-08-14', '助教', '电子工程系');

#课程表
insert into course values('3-105', '计算机导论', '825');
insert into course values('3-245', '操作系统', '804');
insert into course values('6-166', '数字电路', '856');
insert into course values('9-888', '高等数学', '831');

##添加成绩表
insert into score values('103', '3-245', '86');
insert into score values('105', '3-245', '75');
insert into score values('109', '3-245', '68');
insert into score values('103', '3-105', '92');
insert into score values('105', '3-105', '88');
insert into score values('109', '3-105', '76');
insert into score values('103', '9-888', '64');
insert into score values('105', '9-888', '91');
insert into score values('109', '9-888', '78');
insert into score values('103', '6-166', '86');
insert into score values('105', '6-166', '79');
insert into score values('109', '6-166', '81');


--查询练习
--1. 查询student表所有记录
select * from student;
	+-----+-----------+------+---------------------+-------+
| sno | sname     | ssex | sbirthday           | class |
+-----+-----------+------+---------------------+-------+
| 101 | 曾华      | 男   | 1977-09-01 00:00:00 | 95033 |
| 102 | 匡明      | 男   | 1975-10-02 00:00:00 | 95031 |
| 103 | 王丽      | 女   | 1976-01-23 00:00:00 | 95033 |
| 104 | 李军      | 男   | 1976-02-20 00:00:00 | 95033 |
| 105 | 王芳      | 女   | 1975-02-10 00:00:00 | 95031 |
| 106 | 陆君      | 男   | 1974-06-03 00:00:00 | 95031 |
| 107 | 王尼玛    | 男   | 1977-06-07 00:00:00 | 95031 |
| 108 | 张全蛋    | 男   | 1973-08-12 00:00:00 | 95033 |
| 109 | 赵铁柱    | 男   | 1975-06-30 00:00:00 | 95031 |
+-----+-----------+------+---------------------+-------+
9 rows in set (0.00 sec)

--2.查询student表中所有姓名、性别、班级信息
select sname,ssex,class from student;
	+-----------+------+-------+
| sname     | ssex | class |
+-----------+------+-------+
| 曾华      | 男   | 95033 |
| 匡明      | 男   | 95031 |
| 王丽      | 女   | 95033 |
| 李军      | 男   | 95033 |
| 王芳      | 女   | 95031 |
| 陆君      | 男   | 95031 |
| 王尼玛    | 男   | 95031 |
| 张全蛋    | 男   | 95033 |
| 赵铁柱    | 男   | 95031 |
+-----------+------+-------+
9 rows in set (0.00 sec)

--3.查询教师的所有单位即depart列的factor
select depart from teacher;
+-----------------+
| depart          |
+-----------------+
| 计算机系        |
| 计算机系        |
| 电子工程系      |
| 电子工程系      |
+-----------------+
4 rows in set (0.00 sec)
--这种查询是查询所有值，不是factor值，只需要加入distinct
--distinct 排重
select distinct depart from teacher;
+-----------------+
| depart          |
+-----------------+
| 计算机系        |
| 电子工程系      |
+-----------------+
2 rows in set (0.00 sec)

--4.查询分数在60-80之间的所有记录
--查询区间  between …… and ……
select * from score where degree between 60 and 80;
+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 103 | 9-888 |     64 |
| 105 | 3-245 |     75 |
| 105 | 6-166 |     79 |
| 109 | 3-105 |     76 |
| 109 | 3-245 |     68 |
| 109 | 9-888 |     78 |
+-----+-------+--------+
6 rows in set (0.00 sec)

--直接利用运算符号计算
select * from score where degree>60 and degree<80;
+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 103 | 9-888 |     64 |
| 105 | 3-245 |     75 |
| 105 | 6-166 |     79 |
| 109 | 3-105 |     76 |
| 109 | 3-245 |     68 |
| 109 | 9-888 |     78 |
+-----+-------+--------+
6 rows in set (0.00 sec)


--5.查询表中成绩为86，78或者92
--查询或者关系的查询 in
select * from score where degree in(86, 78, 92);
+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 103 | 3-105 |     92 |
| 103 | 3-245 |     86 |
| 103 | 6-166 |     86 |
| 109 | 9-888 |     78 |
+-----+-------+--------+
4 rows in set (0.00 sec)

--6.查询student表中班级为’95031‘或者性别为’女‘的同学记录
--or关键词
select * from student where class='95031' or ssex='女';
+-----+-----------+------+---------------------+-------+
| sno | sname     | ssex | sbirthday           | class |
+-----+-----------+------+---------------------+-------+
| 102 | 匡明      | 男   | 1975-10-02 00:00:00 | 95031 |
| 103 | 王丽      | 女   | 1976-01-23 00:00:00 | 95033 |
| 105 | 王芳      | 女   | 1975-02-10 00:00:00 | 95031 |
| 106 | 陆君      | 男   | 1974-06-03 00:00:00 | 95031 |
| 107 | 王尼玛    | 男   | 1977-06-07 00:00:00 | 95031 |
| 109 | 赵铁柱    | 男   | 1975-06-30 00:00:00 | 95031 |
+-----+-----------+------+---------------------+-------+
6 rows in set (0.00 sec)


--升序降序查询 order by
--7.class降序查询student的所有记录
--降序desc
select * from student order by class desc;  ##降序关键词desc
+-----+-----------+------+---------------------+-------+
| sno | sname     | ssex | sbirthday           | class |
+-----+-----------+------+---------------------+-------+
| 101 | 曾华      | 男   | 1977-09-01 00:00:00 | 95033 |
| 103 | 王丽      | 女   | 1976-01-23 00:00:00 | 95033 |
| 104 | 李军      | 男   | 1976-02-20 00:00:00 | 95033 |
| 108 | 张全蛋    | 男   | 1973-08-12 00:00:00 | 95033 |
| 102 | 匡明      | 男   | 1975-10-02 00:00:00 | 95031 |
| 105 | 王芳      | 女   | 1975-02-10 00:00:00 | 95031 |
| 106 | 陆君      | 男   | 1974-06-03 00:00:00 | 95031 |
| 107 | 王尼玛    | 男   | 1977-06-07 00:00:00 | 95031 |
| 109 | 赵铁柱    | 男   | 1975-06-30 00:00:00 | 95031 |
+-----+-----------+------+---------------------+-------+
9 rows in set (0.01 sec)

--升序asc
select * from student order by class;   #默认升序或者使用关键词asc
+-----+-----------+------+---------------------+-------+
| sno | sname     | ssex | sbirthday           | class |
+-----+-----------+------+---------------------+-------+
| 102 | 匡明      | 男   | 1975-10-02 00:00:00 | 95031 |
| 105 | 王芳      | 女   | 1975-02-10 00:00:00 | 95031 |
| 106 | 陆君      | 男   | 1974-06-03 00:00:00 | 95031 |
| 107 | 王尼玛    | 男   | 1977-06-07 00:00:00 | 95031 |
| 109 | 赵铁柱    | 男   | 1975-06-30 00:00:00 | 95031 |
| 101 | 曾华      | 男   | 1977-09-01 00:00:00 | 95033 |
| 103 | 王丽      | 女   | 1976-01-23 00:00:00 | 95033 |
| 104 | 李军      | 男   | 1976-02-20 00:00:00 | 95033 |
| 108 | 张全蛋    | 男   | 1973-08-12 00:00:00 | 95033 |
+-----+-----------+------+---------------------+-------+
9 rows in set (0.00 sec)

--8.以cno升序、degree降序查询score表中的所有记录
select * from score order by cno asc,degree desc;
+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 103 | 3-105 |     92 |
| 105 | 3-105 |     88 |
| 109 | 3-105 |     76 |
| 103 | 3-245 |     86 |
| 105 | 3-245 |     75 |
| 109 | 3-245 |     68 |
| 103 | 6-166 |     86 |
| 109 | 6-166 |     81 |
| 105 | 6-166 |     79 |
| 105 | 9-888 |     91 |
| 109 | 9-888 |     78 |
| 103 | 9-888 |     64 |
+-----+-------+--------+

--查询’95031‘班的人数
--统计 count
select count(*) from student where class='95031';
+----------+
| count(*) |
+----------+
|        5 |
+----------+
1 row in set (0.00 sec)


--10.score表中最高分的学生学号和课程号
--找最大值或者最小值
select max(degree) from score;
+-------------+
| max(degree) |
+-------------+
|          92 |
+-------------+
1 row in set (0.00 sec)

--查询最大值的学生学号和课程号
select sno,cno from score where degree=(select max(degree) from score);
+-----+-------+
| sno | cno   |
+-----+-------+
| 103 | 3-105 |
+-----+-------+
1 row in set (0.00 sec)


--排序的做法
select cno,sno,degree from score order by degree desc;
+-------+-----+--------+
| cno   | sno | degree |
+-------+-----+--------+
| 3-105 | 103 |     92 |
| 9-888 | 105 |     91 |
| 3-105 | 105 |     88 |
| 3-245 | 103 |     86 |
| 6-166 | 103 |     86 |
| 6-166 | 109 |     81 |
| 6-166 | 105 |     79 |
| 9-888 | 109 |     78 |
| 3-105 | 109 |     76 |
| 3-245 | 105 |     75 |
| 3-245 | 109 |     68 |
| 9-888 | 103 |     64 |
+-------+-----+--------+
12 rows in set (0.00 sec)

--使用limit取出排序后的数据， 0，1，表示从第0个位置开始取1个；
select cno, sno, degree from score order by degree desc limit 0,1;
+-------+-----+--------+
| cno   | sno | degree |
+-------+-----+--------+
| 3-105 | 103 |     92 |
+-------+-----+--------+
1 row in set (0.00 sec)


select cno, sno, degree from score order by degree desc limit 2,3;
+-------+-----+--------+
| cno   | sno | degree |
+-------+-----+--------+
| 3-105 | 105 |     88 |
| 3-245 | 103 |     86 |
| 6-166 | 103 |     86 |
+-------+-----+--------+
3 rows in set (0.00 sec)

--11.查询每门课的平均成绩  关键词：平均avg
select * from course;
+-------+-----------------+-----+
| cno   | cname           | tno |
+-------+-----------------+-----+
| 3-105 | 计算机导论      | 825 |
| 3-245 | 操作系统        | 804 |
| 6-166 | 数字电路        | 856 |
| 9-888 | 高等数学        | 831 |
+-------+-----------------+-----+
4 rows in set (0.00 sec)

--计算某一门的平均成绩
select avg(degree) from score where cno = '3-105';
+-------------+
| avg(degree) |
+-------------+
|     85.3333 |
+-------------+
1 row in set (0.00 sec)

--计算每一门的成绩：写出每个cno或者
select avg(degree) from score group by cno;
+-------------+
| avg(degree) |
+-------------+
|     85.3333 |
|     76.3333 |
|     82.0000 |
|     77.6667 |
+-------------+
4 rows in set (0.00 sec)

--分组  group by
select cno, avg(degree) from score group by cno;
+-------+-------------+
| cno   | avg(degree) |
+-------+-------------+
| 3-105 |     85.3333 |
| 3-245 |     76.3333 |
| 6-166 |     82.0000 |
| 9-888 |     77.6667 |
+-------+-------------+
4 rows in set (0.00 sec)


--12.查询至少有两名同学选修并以3开头的课程的平均分；
select cno from score group by cno;
+-------+
| cno   |
+-------+
| 3-105 |
| 3-245 |
| 6-166 |
| 9-888 |
+-------+
4 rows in set (0.00 sec)

--having 相当于一个条件语句
select cno from score group by cno having count(cno)>=2;
+-------+
| cno   |
+-------+
| 3-105 |
| 3-245 |
| 6-166 |
| 9-888 |
+-------+
4 rows in set (0.00 sec)


--选出人数大于2并且以3开头  like关键字模糊查询 ’3%‘表示以3开头%是模糊数据
select cno from score group by cno having count(cno)>=2 and cno like '3%';
+-------+
| cno   |
+-------+
| 3-105 |
| 3-245 |
+-------+
2 rows in set (0.00 sec)

select cno,avg(degree) from score 
group by cno 
having count(cno)>=2 
and cno like '3%';
+-------+-------------+
| cno   | avg(degree) |
+-------+-------------+
| 3-105 |     85.3333 |
| 3-245 |     76.3333 |
+-------+-------------+
2 rows in set (0.00 sec)

select cno,avg(degree),count(*) from score group by cno having count(cno)>=2 and cno like '3%';
+-------+-------------+----------+
| cno   | avg(degree) | count(*) |
+-------+-------------+----------+
| 3-105 |     85.3333 |        3 |
| 3-245 |     76.3333 |        3 |
+-------+-------------+----------+
2 rows in set (0.00 sec)

--13.查询份数大于70， 小于90的sno列
select sno,degree from score 
where degree between 70 and 90; #或者where degree>70 and degree<90
+-----+--------+
| sno | degree |
+-----+--------+
| 103 |     86 |
| 103 |     86 |
| 105 |     88 |
| 105 |     75 |
| 105 |     79 |
| 109 |     76 |
| 109 |     81 |
| 109 |     78 |
+-----+--------+
8 rows in set (0.00 sec)

--14.查询所有学生的sname、cno和degree列  (多表查询)
--选出学生名字
select sname from student;
+-----------+
| sname     |
+-----------+
| 曾华      |
| 匡明      |
| 王丽      |
| 李军      |
| 王芳      |
| 陆君      |
| 王尼玛    |
| 张全蛋    |
| 赵铁柱    |
+-----------+
9 rows in set (0.00 sec)
--选出cno和degree
select cno,degree from score;

+-------+--------+
| cno   | degree |
+-------+--------+
| 3-105 |     92 |
| 3-245 |     86 |
| 6-166 |     86 |
| 9-888 |     64 |
| 3-105 |     88 |
| 3-245 |     75 |
| 6-166 |     79 |
| 9-888 |     91 |
| 3-105 |     76 |
| 3-245 |     68 |
| 6-166 |     81 |
| 9-888 |     78 |
+-------+--------+
12 rows in set (0.00 sec)

--如何对应在一起  注意二者通过sno对应， 所以分别选出两列的sno

select sno,sname from student;
+-----+-----------+
| sno | sname     |
+-----+-----------+
| 101 | 曾华      |
| 102 | 匡明      |
| 103 | 王丽      |
| 104 | 李军      |
| 105 | 王芳      |
| 106 | 陆君      |
| 107 | 王尼玛    |
| 108 | 张全蛋    |
| 109 | 赵铁柱    |
+-----+-----------+
9 rows in set (0.00 sec)

select sno,cno,degree from score;
+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 103 | 3-105 |     92 |
| 103 | 3-245 |     86 |
| 103 | 6-166 |     86 |
| 103 | 9-888 |     64 |
| 105 | 3-105 |     88 |
| 105 | 3-245 |     75 |
| 105 | 6-166 |     79 |
| 105 | 9-888 |     91 |
| 109 | 3-105 |     76 |
| 109 | 3-245 |     68 |
| 109 | 6-166 |     81 |
| 109 | 9-888 |     78 |
+-----+-------+--------+
12 rows in set (0.00 sec)

--多表查询对应关系用where
select sname,cno,degree from student,score 
where student.sno = score.sno;
+-----------+-------+--------+
| sname     | cno   | degree |
+-----------+-------+--------+
| 王丽      | 3-105 |     92 |
| 王丽      | 3-245 |     86 |
| 王丽      | 6-166 |     86 |
| 王丽      | 9-888 |     64 |
| 王芳      | 3-105 |     88 |
| 王芳      | 3-245 |     75 |
| 王芳      | 6-166 |     79 |
| 王芳      | 9-888 |     91 |
| 赵铁柱    | 3-105 |     76 |
| 赵铁柱    | 3-245 |     68 |
| 赵铁柱    | 6-166 |     81 |
| 赵铁柱    | 9-888 |     78 |
+-----------+-------+--------+
12 rows in set (0.00 sec)

--15.查询所有学生的sno，cname和degree列
select sno,cname,degree from course,score
where course.cno = score.cno;

+-----+-----------------+--------+
| sno | cname           | degree |
+-----+-----------------+--------+
| 103 | 计算机导论      |     92 |
| 105 | 计算机导论      |     88 |
| 109 | 计算机导论      |     76 |
| 103 | 操作系统        |     86 |
| 105 | 操作系统        |     75 |
| 109 | 操作系统        |     68 |
| 103 | 数字电路        |     86 |
| 105 | 数字电路        |     79 |
| 109 | 数字电路        |     81 |
| 103 | 高等数学        |     64 |
| 105 | 高等数学        |     91 |
| 109 | 高等数学        |     78 |
+-----+-----------------+--------+
12 rows in set (0.00 sec)

--16.查询所有学生的sname、cname和degree列  三表查询
select sname,cname,degree from student,course,score
where student.sno = score.sno and score.cno = course.cno;

+-----------+-----------------+--------+
| sname     | cname           | degree |
+-----------+-----------------+--------+
| 王丽      | 计算机导论      |     92 |
| 王芳      | 计算机导论      |     88 |
| 赵铁柱    | 计算机导论      |     76 |
| 王丽      | 操作系统        |     86 |
| 王芳      | 操作系统        |     75 |
| 赵铁柱    | 操作系统        |     68 |
| 王丽      | 数字电路        |     86 |
| 王芳      | 数字电路        |     79 |
| 赵铁柱    | 数字电路        |     81 |
| 王丽      | 高等数学        |     64 |
| 王芳      | 高等数学        |     91 |
| 赵铁柱    | 高等数学        |     78 |
+-----------+-----------------+--------+
12 rows in set (0.00 sec)

select sname,cname,degree,student.sno,course.cno from student,course,score
where student.sno = score.sno and score.cno = course.cno;
+-----------+-----------------+--------+-----+-------+
| sname     | cname           | degree | sno | cno   |
+-----------+-----------------+--------+-----+-------+
| 王丽      | 计算机导论      |     92 | 103 | 3-105 |
| 王芳      | 计算机导论      |     88 | 105 | 3-105 |
| 赵铁柱    | 计算机导论      |     76 | 109 | 3-105 |
| 王丽      | 操作系统        |     86 | 103 | 3-245 |
| 王芳      | 操作系统        |     75 | 105 | 3-245 |
| 赵铁柱    | 操作系统        |     68 | 109 | 3-245 |
| 王丽      | 数字电路        |     86 | 103 | 6-166 |
| 王芳      | 数字电路        |     79 | 105 | 6-166 |
| 赵铁柱    | 数字电路        |     81 | 109 | 6-166 |
| 王丽      | 高等数学        |     64 | 103 | 9-888 |
| 王芳      | 高等数学        |     91 | 105 | 9-888 |
| 赵铁柱    | 高等数学        |     78 | 109 | 9-888 |
+-----------+-----------------+--------+-----+-------+
12 rows in set (0.00 sec)



select sname,cname,degree,student.sno as stu_sno,score.sno as sc_sno,
course.cno as co_cno,score.cno as sc_cno
from student,course,score
where student.sno = score.sno and score.cno = course.cno;

+-----------+-----------------+--------+---------+--------+--------+--------+
| sname     | cname           | degree | stu_sno | sc_sno | co_cno | sc_cno |
+-----------+-----------------+--------+---------+--------+--------+--------+
| 王丽      | 计算机导论      |     92 | 103     | 103    | 3-105  | 3-105  |
| 王芳      | 计算机导论      |     88 | 105     | 105    | 3-105  | 3-105  |
| 赵铁柱    | 计算机导论      |     76 | 109     | 109    | 3-105  | 3-105  |
| 王丽      | 操作系统        |     86 | 103     | 103    | 3-245  | 3-245  |
| 王芳      | 操作系统        |     75 | 105     | 105    | 3-245  | 3-245  |
| 赵铁柱    | 操作系统        |     68 | 109     | 109    | 3-245  | 3-245  |
| 王丽      | 数字电路        |     86 | 103     | 103    | 6-166  | 6-166  |
| 王芳      | 数字电路        |     79 | 105     | 105    | 6-166  | 6-166  |
| 赵铁柱    | 数字电路        |     81 | 109     | 109    | 6-166  | 6-166  |
| 王丽      | 高等数学        |     64 | 103     | 103    | 9-888  | 9-888  |
| 王芳      | 高等数学        |     91 | 105     | 105    | 9-888  | 9-888  |
| 赵铁柱    | 高等数学        |     78 | 109     | 109    | 9-888  | 9-888  |
+-----------+-----------------+--------+---------+--------+--------+--------+
12 rows in set (0.00 sec)


--17.查询’95031‘班学生每门课的平均分
select * from student where class='95031';
+-----+-----------+------+---------------------+-------+
| sno | sname     | ssex | sbirthday           | class |
+-----+-----------+------+---------------------+-------+
| 102 | 匡明      | 男   | 1975-10-02 00:00:00 | 95031 |
| 105 | 王芳      | 女   | 1975-02-10 00:00:00 | 95031 |
| 106 | 陆君      | 男   | 1974-06-03 00:00:00 | 95031 |
| 107 | 王尼玛    | 男   | 1977-06-07 00:00:00 | 95031 |
| 109 | 赵铁柱    | 男   | 1975-06-30 00:00:00 | 95031 |
+-----+-----------+------+---------------------+-------+
5 rows in set (0.00 sec)

select * from score 
where sno in(select sno from student where class='95031');
+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 105 | 3-105 |     88 |
| 105 | 3-245 |     75 |
| 105 | 6-166 |     79 |
| 105 | 9-888 |     91 |
| 109 | 3-105 |     76 |
| 109 | 3-245 |     68 |
| 109 | 6-166 |     81 |
| 109 | 9-888 |     78 |
+-----+-------+--------+
8 rows in set (0.00 sec)

select cno,avg(degree) as '平均分' from score
where sno in(select sno from student where class='95031')
group by cno;

+-------+-----------+
| cno   | 平均分    |
+-------+-----------+
| 3-105 |   82.0000 |
| 3-245 |   71.5000 |
| 6-166 |   80.0000 |
| 9-888 |   84.5000 |
+-------+-----------+
4 rows in set (0.00 sec)


--18.查询选修’3-105‘课程的成绩高于’109‘号同学的所有同学记录
select degree from score
where cno='3-105' and sno='109';
+--------+
| degree |
+--------+
|     76 |
+--------+
1 row in set (0.00 sec)

select * from score 
where cno='3-105' 
and degree>(select degree from score where cno='3-105' and sno='109');
+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 103 | 3-105 |     92 |
| 105 | 3-105 |     88 |
+-----+-------+--------+
2 rows in set (0.00 sec)

--19.查询成绩高于学号为’109‘，课程号为’3-105‘的成绩的所有记录

select * from score 
where degree>(select degree from score where cno='3-105' and sno='109');
+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 103 | 3-105 |     92 |
| 103 | 3-245 |     86 |
| 103 | 6-166 |     86 |
| 105 | 3-105 |     88 |
| 105 | 6-166 |     79 |
| 105 | 9-888 |     91 |
| 109 | 6-166 |     81 |
| 109 | 9-888 |     78 |
+-----+-------+--------+
8 rows in set (0.00 sec)


--20.查询和学号为108、101同学同年出生的所有学生的sno、sname和sbirthday

select sno,sname,sbirthday from student where sno in ('108', '101');
+-----+-----------+---------------------+
| sno | sname     | sbirthday           |
+-----+-----------+---------------------+
| 101 | 曾华      | 1977-09-01 00:00:00 |
| 108 | 张全蛋    | 1973-08-12 00:00:00 |
+-----+-----------+---------------------+
2 rows in set (0.00 sec)

--year()用于查年份  month()查月份 day()查日期 time()查具体时间
select year(sbirthday) from student;
+-----------------+
| year(sbirthday) |
+-----------------+
|            1977 |
|            1975 |
|            1976 |
|            1976 |
|            1975 |
|            1974 |
|            1977 |
|            1973 |
|            1975 |
+-----------------+
9 rows in set (0.00 sec)

--题目要求答案
select sno,sname,sbirthday from student
where year(sbirthday) in (select year(sbirthday) from student where sno in (108, 101));
+-----+-----------+---------------------+
| sno | sname     | sbirthday           |
+-----+-----------+---------------------+
| 101 | 曾华      | 1977-09-01 00:00:00 |
| 107 | 王尼玛    | 1977-06-07 00:00:00 |
| 108 | 张全蛋    | 1973-08-12 00:00:00 |
+-----+-----------+---------------------+
3 rows in set (0.00 sec)

--21.查询‘张旭’教师任课的学生成绩
select * from teacher;
+-----+--------+------+---------------------+-----------+-----------------+
| tno | tname  | tsex | tbirthday           | prof      | depart          |
+-----+--------+------+---------------------+-----------+-----------------+
| 804 | 李成   | 男   | 1958-12-02 00:00:00 | 副教授    | 计算机系        |
| 825 | 王萍   | 女   | 1974-05-05 00:00:00 | 助教      | 计算机系        |
| 831 | 刘冰   | 女   | 1975-08-14 00:00:00 | 助教      | 电子工程系      |
| 856 | 张旭   | 男   | 1966-03-12 00:00:00 | 讲师      | 电子工程系      |
+-----+--------+------+---------------------+-----------+-----------------+
4 rows in set (0.00 sec)

select * from score;
+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 103 | 3-105 |     92 |
| 103 | 3-245 |     86 |
| 103 | 6-166 |     86 |
| 103 | 9-888 |     64 |
| 105 | 3-105 |     88 |
| 105 | 3-245 |     75 |
| 105 | 6-166 |     79 |
| 105 | 9-888 |     91 |
| 109 | 3-105 |     76 |
| 109 | 3-245 |     68 |
| 109 | 6-166 |     81 |
| 109 | 9-888 |     78 |
+-----+-------+--------+
12 rows in set (0.00 sec)

select * from course;
+-------+-----------------+-----+
| cno   | cname           | tno |
+-------+-----------------+-----+
| 3-105 | 计算机导论      | 825 |
| 3-245 | 操作系统        | 804 |
| 6-166 | 数字电路        | 856 |
| 9-888 | 高等数学        | 831 |
+-------+-----------------+-----+
4 rows in set (0.00 sec)
--
select tno from teacher where tname = '张旭';
+-----+
| tno |
+-----+
| 856 |
+-----+
--
select cno from course 
where tno = (select tno from teacher where tname = '张旭');
+-------+
| cno   |
+-------+
| 6-166 |
+-------+
1 row in set (0.00 sec)
--
select * from score
where cno = (select cno from course 
where tno = (select tno from teacher where tname = '张旭'));

+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 103 | 6-166 |     86 |
| 105 | 6-166 |     79 |
| 109 | 6-166 |     81 |
+-----+-------+--------+
3 rows in set (0.00 sec)

--22.查询选修某课程的同学多于5人的教师姓名   #子表关系查询
insert into score values('101', '3-105', '99');
insert into score values('102', '3-105', '67');
insert into score values('104', '3-105', '77');

--
select cno from score group by cno;
+-------+
| cno   |
+-------+
| 3-105 |
| 3-245 |
| 6-166 |
| 9-888 |
+-------+
4 rows in set (0.00 sec)
--
select cno from score group by cno having count(cno) > 5;
+-------+
| cno   |
+-------+
| 3-105 |
+-------+
1 row in set (0.01 sec)
--
select tno from course 
where cno = (select cno from score group by cno having count(cno) > 5);
+-----+
| tno |
+-----+
| 825 |
+-----+
1 row in set (0.01 sec)
--
select tname from teacher 
where tno = (select tno from course 
where cno = (select cno from score group by cno having count(cno) > 5));
+--------+
| tname  |
+--------+
| 王萍   |
+--------+
1 row in set (0.00 sec)

--23.查询‘95033’和‘950332’班全体学生记录  in表示或者关系的集合

insert into student values('110', '张飞', '男', '1178-04-30', '95032');
insert into student values('111', '关羽', '男', '1173-05-13', '95032');

select * from student 
where class in (95033, 95032);
+-----+-----------+------+---------------------+-------+
| sno | sname     | ssex | sbirthday           | class |
+-----+-----------+------+---------------------+-------+
| 101 | 曾华      | 男   | 1977-09-01 00:00:00 | 95033 |
| 103 | 王丽      | 女   | 1976-01-23 00:00:00 | 95033 |
| 104 | 李军      | 男   | 1976-02-20 00:00:00 | 95033 |
| 108 | 张全蛋    | 男   | 1973-08-12 00:00:00 | 95033 |
| 110 | 张飞      | 男   | 1178-04-30 00:00:00 | 95032 |
| 111 | 关羽      | 男   | 1173-05-13 00:00:00 | 95032 |
+-----+-----------+------+---------------------+-------+
6 rows in set (0.00 sec)

--24.查询85分以上的成绩课程cno  ##where条件的使用
select cno,degree from score
where degree > 85;
+-------+--------+
| cno   | degree |
+-------+--------+
| 3-105 |     99 |
| 3-105 |     92 |
| 3-245 |     86 |
| 6-166 |     86 |
| 3-105 |     88 |
| 9-888 |     91 |
+-------+--------+

--25.查询‘计算机系’教师所教课程的成绩表
select * from teacher;
+-----+--------+------+---------------------+-----------+-----------------+
| tno | tname  | tsex | tbirthday           | prof      | depart          |
+-----+--------+------+---------------------+-----------+-----------------+
| 804 | 李成   | 男   | 1958-12-02 00:00:00 | 副教授    | 计算机系        |
| 825 | 王萍   | 女   | 1974-05-05 00:00:00 | 助教      | 计算机系        |
| 831 | 刘冰   | 女   | 1975-08-14 00:00:00 | 助教      | 电子工程系      |
| 856 | 张旭   | 男   | 1966-03-12 00:00:00 | 讲师      | 电子工程系      |
+-----+--------+------+---------------------+-----------+-----------------+
4 rows in set (0.00 sec)

select * from score
where cno in (select cno from course
where tno in (select tno from teacher
where depart = '计算机系'));

+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 103 | 3-245 |     86 |
| 105 | 3-245 |     75 |
| 109 | 3-245 |     68 |
| 101 | 3-105 |     99 |
| 102 | 3-105 |     67 |
| 103 | 3-105 |     92 |
| 104 | 3-105 |     77 |
| 105 | 3-105 |     88 |
| 109 | 3-105 |     76 |
+-----+-------+--------+


--26.查询‘计算机系’和‘电子工程系’不同职称的教师的tname和prof 
--使用union连接不同结果
select * from teacher;
+-----+--------+------+---------------------+-----------+-----------------+
| tno | tname  | tsex | tbirthday           | prof      | depart          |
+-----+--------+------+---------------------+-----------+-----------------+
| 804 | 李成   | 男   | 1958-12-02 00:00:00 | 副教授    | 计算机系        |
| 825 | 王萍   | 女   | 1974-05-05 00:00:00 | 助教      | 计算机系        |
| 831 | 刘冰   | 女   | 1975-08-14 00:00:00 | 助教      | 电子工程系      |
| 856 | 张旭   | 男   | 1966-03-12 00:00:00 | 讲师      | 电子工程系      |
+-----+--------+------+---------------------+-----------+-----------------+
4 rows in set (0.00 sec)

select prof from teacher
where depart='计算机系';
+-----------+
| prof      |
+-----------+
| 副教授    |
| 助教      |
+-----------+

select prof from teacher
where depart='电子工程系';
+--------+
| prof   |
+--------+
| 助教   |
| 讲师   |
+--------+

--接下来只需要让两者的prof不相等就行

select tname,prof from teacher
where depart = '电子工程系' and prof not in (select prof from teacher
where depart='计算机系');
+--------+--------+
| tname  | prof   |
+--------+--------+
| 张旭   | 讲师   |
+--------+--------+

select tname,prof from teacher
where depart = '计算机系' and prof not in (select prof from teacher
where depart='电子工程系');
+--------+-----------+
| tname  | prof      |
+--------+-----------+
| 李成   | 副教授    |
+--------+-----------+
1 row in set (0.00 sec)

--使用union连接不同结果
select tname,prof from teacher
where depart = '电子工程系' and prof not in (select prof from teacher
where depart='计算机系')
union
select tname,prof from teacher
where depart = '计算机系' and prof not in (select prof from teacher
where depart='电子工程系');

+--------+-----------+
| tname  | prof      |
+--------+-----------+
| 张旭   | 讲师      |
| 李成   | 副教授    |
+--------+-----------+
2 rows in set (0.00 sec)


--27.查询选修编号为’‘3-105’‘课程且成绩至少高于选修编号为’3-245‘的同学cno、sno、degree


--至少用any
select * from score 
where cno = '3-105'
and degree > any(select degree from score
where cno = '3-245');

##或者用all
select * from score
where cno = '3-105'
and degree > (select min(degree) from score where cno = '3-245')
order by degree desc;



+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 101 | 3-105 |     99 |
| 103 | 3-105 |     92 |
| 104 | 3-105 |     77 |
| 105 | 3-105 |     88 |
| 109 | 3-105 |     76 |
+-----+-------+--------+
5 rows in set (0.01 sec)

##成绩从高到低排序
select * from score 
where cno = '3-105'
and degree > any(select degree from score
where cno = '3-245')
order by degree desc;

+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 101 | 3-105 |     99 |
| 103 | 3-105 |     92 |
| 105 | 3-105 |     88 |
| 104 | 3-105 |     77 |
| 109 | 3-105 |     76 |
+-----+-------+--------+
5 rows in set (0.00 sec)

--27.查询选修编号为’‘3-105’‘课程且成绩高于选修编号为’3-245‘的同学cno、sno、degree
--所有用关键词all
select * from score 
where cno = '3-105'
and degree > all(select degree from score
where cno = '3-245')
order by degree desc;

--或者
select * from score
where cno = '3-105'
and degree > (select max(degree) from score where cno = '3-245')
order by degree desc;

+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 101 | 3-105 |     99 |
| 103 | 3-105 |     92 |
| 105 | 3-105 |     88 |
+-----+-------+--------+
3 rows in set (0.00 sec)



--29.查询所有教师和同学的name，sex，birthday
--取并用union
--给变量取别名用as


select sname as name,ssex as sex,date(sbirthday) as birthday from student
union
select tname,tsex,date(tbirthday) from teacher;

+-----------+------+------------+
| name      | sex  | birthday   |
+-----------+------+------------+
| 曾华      | 男   | 1977-09-01 |
| 匡明      | 男   | 1975-10-02 |
| 王丽      | 女   | 1976-01-23 |
| 李军      | 男   | 1976-02-20 |
| 王芳      | 女   | 1975-02-10 |
| 陆君      | 男   | 1974-06-03 |
| 王尼玛    | 男   | 1977-06-07 |
| 张全蛋    | 男   | 1973-08-12 |
| 赵铁柱    | 男   | 1975-06-30 |
| 张飞      | 男   | 1178-04-30 |
| 关羽      | 男   | 1173-05-13 |
| 李成      | 男   | 1958-12-02 |
| 王萍      | 女   | 1974-05-05 |
| 刘冰      | 女   | 1975-08-14 |
| 张旭      | 男   | 1966-03-12 |
+-----------+------+------------+
15 rows in set (0.00 sec)

--30.查询女教师和男同学的name，sex，和生日
select sname as 姓名,ssex as 性别,sbirthday as 生日 from student where ssex = '男'
union
select tname, tsex, tbirthday from teacher where tsex = '女';
+-----------+--------+---------------------+
| 姓名      | 性别   | 生日                |
+-----------+--------+---------------------+
| 曾华      | 男     | 1977-09-01 00:00:00 |
| 匡明      | 男     | 1975-10-02 00:00:00 |
| 李军      | 男     | 1976-02-20 00:00:00 |
| 陆君      | 男     | 1974-06-03 00:00:00 |
| 王尼玛    | 男     | 1977-06-07 00:00:00 |
| 张全蛋    | 男     | 1973-08-12 00:00:00 |
| 赵铁柱    | 男     | 1975-06-30 00:00:00 |
| 张飞      | 男     | 1178-04-30 00:00:00 |
| 关羽      | 男     | 1173-05-13 00:00:00 |
| 王萍      | 女     | 1974-05-05 00:00:00 |
| 刘冰      | 女     | 1975-08-14 00:00:00 |
+-----------+--------+---------------------+
11 rows in set (0.00 sec)

--31.查询成绩低于平均成绩的同学的成绩表
--复制一个新的表格做条件筛选
select * from score;
a表								b表
+-----+-------+--------+		+-----+-------+--------+
| sno | cno   | degree |		| sno | cno   | degree |
+-----+-------+--------+		+-----+-------+--------+
| 101 | 3-105 |     99 |		| 101 | 3-105 |     99 |
| 102 | 3-105 |     67 |		| 102 | 3-105 |     67 |
| 103 | 3-105 |     92 |		| 103 | 3-105 |     92 |
| 103 | 3-245 |     86 |		| 103 | 3-245 |     86 |
| 103 | 6-166 |     86 |		| 103 | 6-166 |     86 |
| 103 | 9-888 |     64 |		| 103 | 9-888 |     64 |
| 104 | 3-105 |     77 |		| 104 | 3-105 |     77 |
| 104 | 9-888 |     77 |		| 104 | 9-888 |     77 |
| 105 | 3-105 |     88 |		| 105 | 3-105 |     88 |
| 105 | 3-245 |     75 |		| 105 | 3-245 |     75 |
| 105 | 6-166 |     79 |		| 105 | 6-166 |     79 |
| 105 | 9-888 |     91 |		| 105 | 9-888 |     91 |
| 109 | 3-105 |     76 |		| 109 | 3-105 |     76 |
| 109 | 3-245 |     68 |		| 109 | 3-245 |     68 |
| 109 | 6-166 |     81 |		| 109 | 6-166 |     81 |
| 109 | 9-888 |     78 |		| 109 | 9-888 |     78 |
+-----+-------+--------+		+-----+-------+--------+
16 rows in set (0.00 sec)		16 rows in set (0.00 sec)


select cno, avg(degree) from score
group by cno;

+-------+-------------+
| cno   | avg(degree) |
+-------+-------------+
| 3-105 |     83.1667 |
| 3-245 |     76.3333 |
| 6-166 |     82.0000 |
| 9-888 |     77.5000 |
+-------+-------------+
4 rows in set (0.00 sec)

select * from score a   #把score表当成a表？
where degree < (select avg(degree) from score b where a.cno = b.cno);
+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 102 | 3-105 |     67 |
| 103 | 9-888 |     64 |
| 104 | 3-105 |     77 |
| 104 | 9-888 |     77 |
| 105 | 3-245 |     75 |
| 105 | 6-166 |     79 |
| 109 | 3-105 |     76 |
| 109 | 3-245 |     68 |
| 109 | 6-166 |     81 |
+-----+-------+--------+
9 rows in set (0.00 sec)


--32.查询所有任课教师的Tname和Depart。
select * from teacher;
+-----+--------+------+---------------------+-----------+-----------------+
| tno | tname  | tsex | tbirthday           | prof      | depart          |
+-----+--------+------+---------------------+-----------+-----------------+
| 804 | 李成   | 男   | 1958-12-02 00:00:00 | 副教授    | 计算机系        |
| 825 | 王萍   | 女   | 1974-05-05 00:00:00 | 助教      | 计算机系        |
| 831 | 刘冰   | 女   | 1975-08-14 00:00:00 | 助教      | 电子工程系      |
| 856 | 张旭   | 男   | 1966-03-12 00:00:00 | 讲师      | 电子工程系      |
+-----+--------+------+---------------------+-----------+-----------------+
4 rows in set (0.01 sec)

	--课程表中有课程
select * from course;

+-------+-----------------+-----+
| cno   | cname           | tno |
+-------+-----------------+-----+
| 3-105 | 计算机导论      | 825 |
| 3-245 | 操作系统        | 804 |
| 6-166 | 数字电路        | 856 |
| 9-888 | 高等数学        | 831 |
+-------+-----------------+-----+
	--分数表中有分数
select * from score;

+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 101 | 3-105 |     99 |
| 102 | 3-105 |     67 |
| 103 | 3-105 |     92 |
| 103 | 3-245 |     86 |
| 103 | 6-166 |     86 |
| 103 | 9-888 |     64 |
| 104 | 3-105 |     77 |
| 104 | 9-888 |     77 |
| 105 | 3-105 |     88 |
| 105 | 3-245 |     75 |
| 105 | 6-166 |     79 |
| 105 | 9-888 |     91 |
| 109 | 3-105 |     76 |
| 109 | 3-245 |     68 |
| 109 | 6-166 |     81 |
| 109 | 9-888 |     78 |
+-----+-------+--------+
--找到分数表中上课的编号
select cno from score group by cno;
+-------+
| cno   |
+-------+
| 3-105 |
| 3-245 |
| 6-166 |
| 9-888 |
+-------+
4 rows in set (0.00 sec)

--根据分数表中上课编号cno找到课程表中教师的tno
select tno from course 
where cno in (select cno from score group by cno);
+-----+
| tno |
+-----+
| 804 |
| 825 |
| 831 |
| 856 |
+-----+
--根据所选出来的tno确定教师表中的姓名和公寓
select tname, depart from teacher
where tno in (select tno from course 
	where cno in (select cno from score group by cno));

+--------+-----------------+
| tname  | depart          |
+--------+-----------------+
| 李成   | 计算机系        |
| 王萍   | 计算机系        |
| 刘冰   | 电子工程系      |
| 张旭   | 电子工程系      |
+--------+-----------------+

--33.查询至少有三名男生的班号。

select * from student;
+-----+-----------+------+---------------------+-------+
| sno | sname     | ssex | sbirthday           | class |
+-----+-----------+------+---------------------+-------+
| 101 | 曾华      | 男   | 1977-09-01 00:00:00 | 95033 |
| 102 | 匡明      | 男   | 1975-10-02 00:00:00 | 95031 |
| 103 | 王丽      | 女   | 1976-01-23 00:00:00 | 95033 |
| 104 | 李军      | 男   | 1976-02-20 00:00:00 | 95033 |
| 105 | 王芳      | 女   | 1975-02-10 00:00:00 | 95031 |
| 106 | 陆君      | 男   | 1974-06-03 00:00:00 | 95031 |
| 107 | 王尼玛    | 男   | 1977-06-07 00:00:00 | 95031 |
| 108 | 张全蛋    | 男   | 1973-08-12 00:00:00 | 95033 |
| 109 | 赵铁柱    | 男   | 1975-06-30 00:00:00 | 95031 |
| 110 | 张飞      | 男   | 1178-04-30 00:00:00 | 95032 |
| 111 | 关羽      | 男   | 1173-05-13 00:00:00 | 95032 |
+-----+-----------+------+---------------------+-------+

select count(ssex = '女'), class from student group by class;


select count(class), class from student
where ssex = '男' group by class having count(*) > 2;

+--------------+-------+
| count(class) | class |
+--------------+-------+
|            3 | 95033 |
|            4 | 95031 |
+--------------+-------+
2 rows in set (0.00 sec)


--34.查询学生表中不姓王的同学的记录。
select * from student where sname not like '王%';  #模糊查询用like
+-----+-----------+------+---------------------+-------+
| sno | sname     | ssex | sbirthday           | class |
+-----+-----------+------+---------------------+-------+
| 101 | 曾华      | 男   | 1977-09-01 00:00:00 | 95033 |
| 102 | 匡明      | 男   | 1975-10-02 00:00:00 | 95031 |
| 104 | 李军      | 男   | 1976-02-20 00:00:00 | 95033 |
| 106 | 陆君      | 男   | 1974-06-03 00:00:00 | 95031 |
| 108 | 张全蛋    | 男   | 1973-08-12 00:00:00 | 95033 |
| 109 | 赵铁柱    | 男   | 1975-06-30 00:00:00 | 95031 |
| 110 | 张飞      | 男   | 1178-04-30 00:00:00 | 95032 |
| 111 | 关羽      | 男   | 1173-05-13 00:00:00 | 95032 |
+-----+-----------+------+---------------------+-------+
8 rows in set (0.00 sec)

--35.查询student表中每个学生的姓名和年龄

--用select year(now());表示现在的年份
select year(now());
+-------------+
| year(now()) |
+-------------+
|        2019 |
+-------------+

select time(now());
+-------------+
| time(now()) |
+-------------+
| 16:38:23    |
+-------------+
1 row in set (0.00 sec)

select date(now())
union
select time(now());

select sname as 学生姓名, (select year(now()) - year(sbirthday)) as 学生年龄 from student;

+-----------+--------------+
| 学生姓名    | 学生年龄     |
+-----------+--------------+
| 曾华      |           42 |
| 匡明      |           44 |
| 王丽      |           43 |
| 李军      |           43 |
| 王芳      |           44 |
| 陆君      |           45 |
| 王尼玛    |           42 |
| 张全蛋    |           46 |
| 赵铁柱    |           44 |
| 张飞      |          841 |
| 关羽      |          846 |
+-----------+--------------+
11 rows in set (0.01 sec)



--36.查询student表中最大和最小的sbirthday日期值

select max(date(sbirthday)),min(date(sbirthday)) from student;

+----------------------+----------------------+
| max(date(sbirthday)) | min(date(sbirthday)) |
+----------------------+----------------------+
| 1977-09-01           | 1173-05-13           |
+----------------------+----------------------+
1 row in set (0.00 sec)

或者：先排序，再进行操作 使用limit函数进行筛选， ? item 寻求帮助文档

select * from student order by sbirthday desc limit 0, 1


--37. 以班号和年龄降序排列学生表
select * from student order by class desc,sbirthday;
+-----+-----------+------+---------------------+-------+
| sno | sname     | ssex | sbirthday           | class |
+-----+-----------+------+---------------------+-------+
| 108 | 张全蛋    | 男   | 1973-08-12 00:00:00 | 95033 |
| 103 | 王丽      | 女   | 1976-01-23 00:00:00 | 95033 |
| 104 | 李军      | 男   | 1976-02-20 00:00:00 | 95033 |
| 101 | 曾华      | 男   | 1977-09-01 00:00:00 | 95033 |
| 111 | 关羽      | 男   | 1173-05-13 00:00:00 | 95032 |
| 110 | 张飞      | 男   | 1178-04-30 00:00:00 | 95032 |
| 106 | 陆君      | 男   | 1974-06-03 00:00:00 | 95031 |
| 105 | 王芳      | 女   | 1975-02-10 00:00:00 | 95031 |
| 109 | 赵铁柱    | 男   | 1975-06-30 00:00:00 | 95031 |
| 102 | 匡明      | 男   | 1975-10-02 00:00:00 | 95031 |
| 107 | 王尼玛    | 男   | 1977-06-07 00:00:00 | 95031 |
+-----+-----------+------+---------------------+-------

--38.查询男教师及其所上的课程

select tno from teacher where tsex = '男';
+-----+
| tno |
+-----+
| 804 |
| 856 |
+-----+
2 rows in set (0.00 sec)

select cname from course 
where course.tno in (select tno from teacher where tsex = '男');
+--------------+
| cname        |
+--------------+
| 操作系统     |
| 数字电路     |
+--------------+
2 rows in set (0.00 sec)

--39.查询最高分同学的sno、cno和degree
select * from score order by degree desc limit 0,1;
+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 101 | 3-105 |     99 |
+-----+-------+--------+
1 row in set (0.00 sec)


--40.查询和李军同性别的所有同学的姓名。
select  ssex from student where sname = '李军';
+------+
| ssex |
+------+
| 男   |
+------+
1 row in set (0.00 sec)

select sname from student 
where ssex = (select  ssex from student where sname = '李军'); 
+-----------+
| sname     |
+-----------+
| 曾华      |
| 匡明      |
| 李军      |
| 陆君      |
| 王尼玛    |
| 张全蛋    |
| 赵铁柱    |
| 张飞      |
| 关羽      |
+-----------+
9 rows in set (0.00 sec)

--41.查询和李军同性别但不同班的同学

select ssex from student where sname = '李军';


select * from student 
where ssex = (select ssex from student where sname = '李军')
and class != (select class from student where sname = '李军');
+-----+-----------+------+---------------------+-------+
| sno | sname     | ssex | sbirthday           | class |
+-----+-----------+------+---------------------+-------+
| 102 | 匡明      | 男   | 1975-10-02 00:00:00 | 95031 |
| 106 | 陆君      | 男   | 1974-06-03 00:00:00 | 95031 |
| 107 | 王尼玛    | 男   | 1977-06-07 00:00:00 | 95031 |
| 109 | 赵铁柱    | 男   | 1975-06-30 00:00:00 | 95031 |
| 110 | 张飞      | 男   | 1178-04-30 00:00:00 | 95032 |
| 111 | 关羽      | 男   | 1173-05-13 00:00:00 | 95032 |
+-----+-----------+------+---------------------+-------+
6 rows in set (0.01 sec)


--42.查询所有选修’计算机导论‘课程的’男‘同学的成绩表

select cno from course where cname = '计算机导论';
select * from student;

select * from score
where  cno = (select cno from course where cname = '计算机导论')  #先找选了计算机课的同学
and sno in (select sno from student where ssex = '男');   #再找男同学
+-----+-------+--------+
| sno | cno   | degree |
+-----+-------+--------+
| 101 | 3-105 |     99 |
| 102 | 3-105 |     67 |
| 104 | 3-105 |     77 |
| 109 | 3-105 |     76 |
+-----+-------+--------+
4 rows in set (0.00 sec)


--43.创建一个等级表
create table grade(
	low int(3),
	upp int(3),
	grade char(1)
);

insert into grade values(90, 100, 'A');
insert into grade values(80, 89, 'B');
insert into grade values(70, 79, 'C');
insert into grade values(60, 69, 'D');
insert into grade values(0, 59, 'E');


select * from grade;
	+------+------+-------+
| low  | upp  | grade |
+------+------+-------+
|   90 |  100 | A     |
|   80 |   89 | B     |
|   70 |   79 | C     |
|   60 |   69 | D     |
|    0 |   59 | E     |
+------+------+-------+
5 rows in set (0.00 sec)

--先查询所有同学的sno,cno,等级。
select cno, sno, grade from score, grade
where degree between low and upp;
+-------+-----+-------+
| cno   | sno | grade |
+-------+-----+-------+
| 3-105 | 101 | A     |
| 3-105 | 102 | D     |
| 3-105 | 103 | A     |
| 3-245 | 103 | B     |
| 6-166 | 103 | B     |
| 9-888 | 103 | D     |
| 3-105 | 104 | C     |
| 9-888 | 104 | C     |
| 3-105 | 105 | B     |
| 3-245 | 105 | C     |
| 6-166 | 105 | C     |
| 9-888 | 105 | A     |
| 3-105 | 109 | C     |
| 3-245 | 109 | D     |
| 6-166 | 109 | B     |
| 9-888 | 109 | C     |
+-------+-----+-------+













